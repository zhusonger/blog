---
title: Unity 针对Android&iOS平台的处理
author: Zhusong
layout: post
footer: true
category: Unity
date: 2020-7-21
sitemap: false
excerpt: "Unity"
abstract: ""
---

# iOS

## 导出Xcode项目自动配置PostProcessBuild

* 读取路径

	```c#
	string projectPath = path + "/Unity-iPhone.xcodeproj/project.pbxproj";
	PBXProject proj = new PBXProject();
	proj.ReadFromFile(projectPath);
	```

* 获取GUID
	
	```c#
	// Unity-iPhone
	string target = proj.GetUnityMainTargetGuid();
	// UnityFrameWork
	string target = proj.GetUnityFrameworkTargetGuid();
	```

* Build Setting设置属性

	```c#
	// 关闭BITCODE
	proj.SetBuildProperty(target, "ENABLE_BITCODE", "NO");
	```
* Build Setting添加属性
	
	```c#
	// Other LinkerFlags添 加-lstdc++
	proj.AddBuildProperty(target, "OTHER_LDFLAGS", "-lstdc++");
	```
* Build Phases设置头文件public

	```
	// 设置XXX.h为public访问, 供外部访问
	string guid = pbxProject.FindFileGuidByProjectPath("Libraries/Plugins/iOS/XXX.h");
	// 一般target为UnityFrameWork的
	pbxProject.AddPublicHeaderToBuild(target, guid);
	```

* 保存

	```c#
	proj.WriteToFile(projectPath);
	```	